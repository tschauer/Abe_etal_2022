


##################################################################################################################################
##################################################################################################################################


library(ShortRead)
library(rtracklayer)


args = commandArgs(trailingOnly=TRUE)


##################################################################################################################################
##################################################################################################################################



grs <- readRDS(grep("rds", args, value = TRUE))


write.table(length(grs), file = grep("mapped2", args, value = TRUE), sep = "", quote = FALSE, row.names = FALSE, col.names = FALSE)



##################################################################################################################################
##################################################################################################################################



if(as.logical(args[2])){
    
    grs$chr_start <- paste(seqnames(grs), start(grs), sep="_")
    grs$chr_end <-   paste(seqnames(grs), end(grs),   sep="_")
    
    grs <- grs[!(duplicated(grs$chr_start)) & !(duplicated(grs$chr_end))]
    
}


write.table(length(grs), file = grep("filtered", args, value = TRUE), sep = "", quote = FALSE, row.names = FALSE, col.names = FALSE)




##################################################################################################################################
##################################################################################################################################


