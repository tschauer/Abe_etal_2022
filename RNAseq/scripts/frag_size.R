


##################################################################################################################################
##################################################################################################################################


library(ShortRead)
library(rtracklayer)


args = commandArgs(trailingOnly=TRUE)


##################################################################################################################################
##################################################################################################################################



gap <- readGAlignmentPairs(args[1])
grs <- granges(gap, on.discordant.seqnames="drop")



##################################################################################################################################
##################################################################################################################################


pdf(file = args[2], height = 6, width = 6)
par(oma=c(2,2,2,2), mar=c(4,4,4,2))


plot(density(width(grs), from = 0, to = 1000),
     xlab = "Fragment Size", lwd = 2,
     main = gsub(".*\\/|\\..*", "", args[1]))

dev.off()


##################################################################################################################################
##################################################################################################################################


